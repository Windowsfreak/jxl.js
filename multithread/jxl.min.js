!function(){"use strict";let e={useCache:!0,imageType:"jpeg"},t;function n(e){e instanceof HTMLImageElement&&e.src.endsWith(".jxl")?e.complete&&0===e.naturalHeight?a(e,!1):e.onerror=()=>a(e,!1):e instanceof Element&&getComputedStyle(e).backgroundImage.endsWith('.jxl")')&&a(e,!0)}function r(n,r,a){let c=n.dataset.jxlSrc;if(r instanceof Blob){let l=URL.createObjectURL(r);a?n.style.backgroundImage='url("'+l+'")':n.src=l}else{let o=document.createElement("canvas");o.width=r.width,o.height=r.height,o.getContext("2d").putImageData(r,0,0),o.toBlob(r=>{let l=URL.createObjectURL(r);a?n.style.backgroundImage='url("'+l+'")':n.src=l,e.useCache&&t&&t.put(c,new Response(r))},"image/"+e.imageType)}}async function a(n,a){let l=n.dataset.jxlSrc=a?getComputedStyle(n).backgroundImage.slice(5,-2):n.currentSrc;if(n.srcset="",n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",e.useCache){try{t=t||await caches.open("jxl")}catch(o){}let i=t&&await t.match(l);if(i){let s=await i.blob();requestAnimationFrame(()=>r(n,s,a));return}}let u=await fetch(l);requestAnimationFrame(()=>c(u,n,a))}async function c(e,t,n){let a,c,l,o,i;function s(){o.read().then(u,$)}function u(e){if(e.done){h();return}let t=0;for(;t<e.value.length;){let n=e.value.length-t;n>1048576&&(n=1048576),a.HEAP8.set(e.value.slice(t,t+n),l),t+=n,d(n)||$("Processing error")}setTimeout(s,0)}function d(e){let o=function e(n){let r={error:!1,wantFlush:!1,copyPixels:!1};i=i||performance.now();let o=a._jxlProcessInput(c,l,n);return 2===o||(1===o?(r.wantFlush=!0,r.copyPixels=!0):0===o?(console.log("Finished decoding",t.dataset.jxlSrc,"in",performance.now()-i,"ms"),r.wantFlush=!1,r.copyPixels=!0):r.error=!0),r}(e);if(o.error)return!1;if(o.wantFlush&&a._jxlFlush(c),o.copyPixels){let s=a.HEAP32[c>>2],u=a.HEAP32[c+4>>2],d=a.HEAP32[c+8>>2],$=new Uint8Array(a.HEAP8.buffer),h=new ImageData(new Uint8ClampedArray($.slice(d,d+s*u*4)),s,u);requestAnimationFrame(()=>r(t,h,n))}return!0}function $(e){console.error(e),h()}function h(){a._jxlDestroyInstance(c),a._free(l),a=c=l=void 0}if((c=(a=await JxlCodecModule())._jxlCreateInstance(!0,100))<4)return $("Cannot create decoder");l=a._malloc(1048576),o=e.body.getReader(),s()}if(!crossOriginIsolated)throw"No COOP/COEP response headers";let l=WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),o=document.createElement("script");o.src=l?"jxl_decoder_simd.min.js":"jxl_decoder.min.js",o.onload=function e(){document.body&&document.body.querySelectorAll("*").forEach(n),new MutationObserver(e=>e.forEach(e=>e.addedNodes.forEach(n))).observe(document.documentElement,{subtree:!0,childList:!0})},document.head.appendChild(o)}();